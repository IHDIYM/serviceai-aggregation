{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/ihdiym/Desktop/MNW/complaints_extraction/serviceai-aggregation-2/frontend/src/components/AuthForm.tsx"],"sourcesContent":["\"use client\";\nimport { useState } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport { signInWithEmailAndPassword } from \"firebase/auth\";\nimport { auth } from \"@/lib/firebase\";\n\ntype Role = \"user\" | \"manager\" | \"technician\";\n\ninterface AuthFormProps {\n  formType: \"login\" | \"signup\";\n  role?: Role;\n}\n\nexport default function AuthForm({ formType, role }: AuthFormProps) {\n  const router = useRouter();\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [firstName, setFirstName] = useState(\"\");\n  const [lastName, setLastName] = useState(\"\");\n  const [department, setDepartment] = useState(\"\");\n  const [specialTech, setSpecialTech] = useState(\"\");\n  const [location, setLocation] = useState(\"\");\n  const [message, setMessage] = useState(\"\");\n\n  const handleGetCurrentLocation = async () => {\n    if (!navigator.geolocation) {\n      setMessage(\"Geolocation is not supported by your browser.\");\n      return;\n    }\n\n    setMessage(\"Getting location...\");\n    navigator.geolocation.getCurrentPosition(async (position) => {\n      const { latitude, longitude } = position.coords;\n      try {\n        const response = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${latitude}&lon=${longitude}`);\n        const data = await response.json();\n        if (data && data.display_name) {\n          setLocation(data.display_name);\n          setMessage(\"Location found!\");\n        } else {\n          setMessage(\"Could not find address for your location.\");\n        }\n      } catch (error) {\n        setMessage(\"Failed to fetch address.\");\n      }\n    }, () => {\n      setMessage(\"Unable to retrieve your location. Please check browser permissions.\");\n    });\n  };\n\n  const handleSubmit = async (e: React.FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    setMessage(\"\");\n\n    if (formType === \"signup\") {\n      const signupData: any = { email, password, role, firstName, lastName };\n      if (role === 'manager') signupData.department = department;\n      if (role === 'technician') signupData.specialTech = specialTech;\n      if (role === 'user') signupData.location = location;\n\n      try {\n        const res = await fetch('http://localhost:4000/signup', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify(signupData),\n        });\n        const data = await res.json();\n        if (!res.ok) throw new Error(data.error || \"Signup failed\");\n        \n        // After successful signup, log the user in and redirect to dashboard\n        await signInWithEmailAndPassword(auth, email, password);\n        router.push(\"/dashboard\");\n\n      } catch (error: any) {\n        setMessage(error.message);\n      }\n    } else { // Login logic\n      try {\n        await signInWithEmailAndPassword(auth, email, password);\n        router.push(\"/dashboard\");\n      } catch (error: any) {\n        setMessage(error.message);\n      }\n    }\n  };\n\n  const title = formType === 'login' ? 'Login' : `Sign Up as ${role?.charAt(0).toUpperCase() + role!.slice(1)}`;\n\n  return (\n    <div className=\"max-w-md mx-auto\">\n      <h1 className=\"text-2xl font-bold text-center mb-6\">{title}</h1>\n      <form onSubmit={handleSubmit} className=\"flex flex-col gap-4\">\n        {formType === 'signup' && (\n          <>\n            <label htmlFor=\"firstName\" className=\"font-medium\">First Name</label>\n            <input id=\"firstName\" type=\"text\" placeholder=\"First Name\" value={firstName} onChange={e => setFirstName(e.target.value)} className=\"border p-2 rounded\" required />\n            <label htmlFor=\"lastName\" className=\"font-medium\">Last Name</label>\n            <input id=\"lastName\" type=\"text\" placeholder=\"Last Name\" value={lastName} onChange={e => setLastName(e.target.value)} className=\"border p-2 rounded\" required />\n          </>\n        )}\n        <label htmlFor=\"email\" className=\"font-medium\">Email</label>\n        <input id=\"email\" type=\"email\" placeholder=\"Email\" value={email} onChange={e => setEmail(e.target.value)} className=\"border p-2 rounded\" required />\n        <label htmlFor=\"password\" className=\"font-medium\">Password</label>\n        <input id=\"password\" type=\"password\" placeholder=\"Password\" value={password} onChange={e => setPassword(e.target.value)} className=\"border p-2 rounded\" required />\n\n        {formType === 'signup' && role === 'user' && (\n          <div className=\"flex flex-col gap-1\">\n            <label htmlFor=\"location\" className=\"font-medium\">Living Location</label>\n            <div className=\"flex items-center gap-2\">\n              <input id=\"location\" type=\"text\" placeholder=\"Living Location\" value={location} onChange={e => setLocation(e.target.value)} className=\"border p-2 rounded w-full\" required />\n              <button type=\"button\" onClick={handleGetCurrentLocation} className=\"bg-gray-200 p-2 rounded text-sm whitespace-nowrap\">Use Current</button>\n            </div>\n          </div>\n        )}\n        {formType === 'signup' && role === 'manager' && (\n          <>\n            <label htmlFor=\"department\" className=\"font-medium\">Department</label>\n            <input id=\"department\" type=\"text\" placeholder=\"Department\" value={department} onChange={e => setDepartment(e.target.value)} className=\"border p-2 rounded\" required />\n          </>\n        )}\n        {formType === 'signup' && role === 'technician' && (\n          <>\n            <label htmlFor=\"specialTech\" className=\"font-medium\">Special Tech</label>\n            <input id=\"specialTech\" type=\"text\" placeholder=\"Special Tech\" value={specialTech} onChange={e => setSpecialTech(e.target.value)} className=\"border p-2 rounded\" required />\n          </>\n        )}\n        <button type=\"submit\" className=\"bg-blue-600 text-white p-2 rounded hover:bg-blue-700\">\n          {formType === 'login' ? 'Login' : 'Sign Up'}\n        </button>\n        {message && <p className=\"mt-2 text-center text-red-600\">{message}</p>}\n      </form>\n    </div>\n  );\n} "],"names":[],"mappings":"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","debugId":null}}]
}